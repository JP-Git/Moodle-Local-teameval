define ("local_teameval/submitquestion",["jquery","core/templates","core/ajax","core/notification","core/str"],function(a,b,c,e,f){var g;return{submit:function submit(){var b=0;a(".local-teameval-submit-buttons .submit").prop("disabled",!0);var d=a("#local-teameval-questions").find(".question-container").map(function(){return a(this).data("question")});d.sort(function(c,a){return parseInt(a.optional)-parseInt(c.optional)});var h=d.map(function(){var c=a.Deferred(),d=this.submit(function(b){var e=a.Deferred();if(b&&b.methodname){c.resolve({question:this,ajaxCall:b,deferred:e})}else{c.resolve();e.resolve()}return e.promise()});if(!d){b++}return c});a.when.apply(a,h).done(function(){var h=[].slice.call(arguments).filter(function(a){return a!==void 0}),j=a.Deferred();h.push({ajaxCall:{methodname:"local_teameval_questionnaire_submitted",args:{cmid:g}},deferred:j});for(var k=c.call(h.map(function(a){return a.ajaxCall})),l=0;l<h.length;l++){var m=k[l],n=h[l].deferred;m.done(n.resolve);m.fail(n.reject);m.progress(n.notify)}var d=a.when.apply(a,k);d.always(function(){a(".local-teameval-submit-buttons .submit").prop("disabled",!1)}).done(function(){if(0<b){var c=1==b?"incompletewarning1":"incompletewarning";f.get_string(c,"local_teameval",b).done(function(b){a(".local-teameval-submit-buttons .results.incomplete").text(b).show("fast")})}else{a(".local-teameval-submit-buttons .results.incomplete").hide("fast");a(".local-teameval-submit-buttons .results.saved").show("fast").delay(5e3).hide("fast")}}).fail(e.exception)})},reset:function reset(){var b=a("#local-teameval-questions").find(".question-container").map(function(){return a(this).data("question")});a.when(b.map(function(){return this.reset()})).done(function(){}).fail(e.exception)},initialise:function initialise(c){g=c;b.render("local_teameval/submit_buttons",{}).done(function(c,d){var e=a(".local-teameval-containerbox");e.append(c);b.runTemplateJS(d);a(".local-teameval-submit-buttons .submit").click(this.submit);a(".local-teameval-submit-buttons .reset").click(this.reset)}.bind(this))}}});
//# sourceMappingURL=submitquestion.min.js.map
